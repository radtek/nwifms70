SQL execution error, ORA-00979: not a GROUP BY expression

SELECT DISTINCT A.ASSET_CODE||'|'||NVL(B.ASS_ISIN_CODE, NVL(B.ASS_MSTC_CODE, NVL(B.ASS_SEDOL_NUM, NVL(B.ASS_COMMON_CODE, NVL(B.RED_CODE, B.ASS_PID))))) "ASSET", C.MARKET, D.MARKET, E.COST, B.SOURCE, DECODE(A.PORTFOLIO,NULL,1,1) "STATUS", DECODE(NVL(A.DEAL_TYPE, '9'), 'TRS', 1, 1) "TRS", DECODE(SUM(DECODE(DIR, 'P', 1, 'S', -1)*A.NOM_AMOUNT), NULL, 1,1) "ID" FROM SEMAM.NW_CF_ALL_TICKETS A, SEMAM.NW_ASSETS B, SEMAM.NW_MARKET_PRICES C, SEMAM.NW_MARKET_PRICES D, SEMAM.NW_ASSET_COST E, SEMAM.NW_PORTFOLIOS Z WHERE B.ASS_CODE = A.ASSET_CODE AND B.ASS_INDUSTRY NOT IN ('CURRENCY FWDS') AND C.ASSET(+) = B.ASS_CODE AND C.PR_DATE(+) = '02/28/2017' AND D.ASSET(+) = B.ASS_CODE AND D.PR_DATE(+) = '03/01/2017' AND E.ASSET_CODE(+) = B.ASS_CODE AND Z.PORTFOLIO = A.PORTFOLIO AND Z.STATUS IS NULL AND A.TRADE_DATE <= '03/01/2017' GROUP BY A.ASSET_CODE, A.PORTFOLIO, NVL(A.DEAL_TYPE, '9'), C.MARKET, D.MARKET, E.COST, B.SOURCE HAVING TRUNC(SUM(DECODE(DIR, 'P', 1, 'S', -1)*A.NOM_AMOUNT), 0) != 0 UNION SELECT DISTINCT A.ASSET_CODE||'|'||NVL(B.ASS_ISIN_CODE, NVL(B.ASS_MSTC_CODE, NVL(B.ASS_SEDOL_NUM, NVL(B.ASS_COMMON_CODE, NVL(B.RED_CODE, B.ASS_PID))))) "ASSET", C.MARKET, D.MARKET, E.COST, B.SOURCE, DECODE(A.PORTFOLIO,NULL,1,1) "STATUS", DECODE(NVL(A.DEAL_TYPE, '9'), 'TRS', 1, 1) "TRS", 1 "ID" FROM SEMAM.NW_CF_ALL_TICKETS A, SEMAM.NW_ASSETS B, SEMAM.NW_MARKET_PRICES C, SEMAM.NW_MARKET_PRICES D, SEMAM.NW_ASSET_COST E, SEMAM.NW_PORTFOLIOS Z WHERE B.ASS_CODE = A.ASSET_CODE AND B.ASS_INDUSTRY IN ('CURRENCY FWDS') AND C.ASSET(+) = B.ASS_CODE AND C.PR_DATE(+) = '02/28/2017' AND D.ASSET(+) = B.ASS_CODE AND D.PR_DATE(+) = '03/01/2017' AND E.ASSET_CODE(+) = B.ASS_CODE AND A.TRADE_DATE <= '03/01/2017' AND A.VALUE_DATE > '03/01/2017' AND Z.PORTFOLIO = A.PORTFOLIO AND Z.STATUS IS NULL UNION SELECT A.ASSET_CODE||'|'||NVL(B.ASS_ISIN_CODE, NVL(B.ASS_MSTC_CODE, NVL(B.ASS_SEDOL_NUM, NVL(B.ASS_COMMON_CODE, NVL(B.RED_CODE, B.ASS_PID))))) "ASSET", C.MARKET, D.MARKET, E.COST, B.SOURCE, DECODE(A.TRANS_NUM, 1,1,1), 1, 1 FROM SEMAM.NW_TEMP_OPTIONS A, SEMAM.NW_ASSETS B, SEMAM.NW_MARKET_PRICES C, SEMAM.NW_MARKET_PRICES D, SEMAM.NW_ASSET_COST E, SEMAM.NW_CURRENCY X, SEMAM.NW_PORTFOLIOS Z WHERE B.ASS_CODE = A.ASSET_CODE AND C.ASSET(+) = A.ASSET_CODE AND C.PR_DATE(+) = '02/28/2017' AND D.ASSET(+) = A.ASSET_CODE AND D.PR_DATE(+) = '03/01/2017' AND E.ASSET_CODE(+) = A.ASSET_CODE AND X.CURRENCY = A.CURRENCY AND Z.PORTFOLIO = A.PORTFOLIO AND Z.STATUS IS NULL AND A.TRANS_TYPE IN ('CALL', 'PUT') AND A.NOM_AMOUNT > 0 UNION SELECT DISTINCT A.ASSET_CODE||'|'||NVL(B.ASS_ISIN_CODE, NVL(B.ASS_MSTC_CODE, NVL(B.ASS_SEDOL_NUM, NVL(B.ASS_COMMON_CODE, NVL(B.RED_CODE, B.ASS_PID))))) "ASSET", C.MARKET, D.MARKET, E.COST, B.SOURCE, 1 "STATUS", 1 "TRS", 1 "ID" FROM SEMAM.ALL_TICKET_INV_V A, SEMAM.NW_ASSETS B, SEMAM.NW_MARKET_PRICES C, SEMAM.NW_MARKET_PRICES D, SEMAM.NW_ASSET_COST E, SEMAM.NW_PORTFOLIOS Z WHERE B.ASS_CODE = A.ASSET_CODE AND C.ASSET(+) = B.ASS_CODE AND C.PR_DATE(+) = '02/28/2017' AND D.ASSET(+) = B.ASS_CODE AND D.PR_DATE(+) = '03/01/2017' AND E.ASSET_CODE(+) = B.ASS_CODE AND Z.PORTFOLIO = A.PORTFOLIO AND Z.STATUS IS NULL AND A.TRADE_DATE <= '03/01/2017' AND A.TRANS_TYPE IN ('REPO', 'LEVERAGE') AND NVL(ACTUAL_VDATE, NVL(MATURITY_DATE, TO_DATE('03/01/2017') + 1)) > '03/01/2017' ORDER BY 1 